{"version":3,"sources":["App.js","services/pdfService.js","reportWebVitals.js","index.js"],"names":["ctx","page","renderCtx","axios","Axios","create","withCredentials","baseUrl","getPdf","id","get","then","res","data","savePdf","pdf","post","pdfjsLib","workerSrc","pdfjsWorker","loadedPdf","isDrawMode","file","FileReader","App","pdfId","window","location","pathname","slice","canvasRef","useRef","useState","isLoading","setIsLoading","link","setLink","isEditMode","setIsEditMode","a","onRenderCtx","useEffect","current","getContext","onGetPdf","handlePdf","e","onload","result","readAsDataURL","target","files","promise","doc","getPage","getViewport","scale","viewport","height","width","canvasContext","render","startPosition","finishPosition","beginPath","draw","x","y","lineWidth","lineCap","lineTo","stroke","clearRect","pdfToSave","savedPdf","origin","_id","className","type","accept","onChange","hidden","onClick","prev","toDataURL","console","log","navigator","share","htmlFor","ref","onMouseDown","onMouseMove","nativeEvent","which","offsetX","offsetY","onMouseUp","onTouchStart","onTouchMove","touches","length","clientX","offsetLeft","clientY","offsetTop","onTouchEnd","style","touchAction","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.04e668fe.chunk.js","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport * as pdfjsLib from 'pdfjs-dist/build/pdf';\nimport pdfjsWorker from 'pdfjs-dist/build/pdf.worker.entry';\nimport { getPdf, savePdf } from './services/pdfService';\n\npdfjsLib.GlobalWorkerOptions.workerSrc = pdfjsWorker;\n\nlet ctx;\nlet page;\nlet renderCtx;\nlet isDrawMode = false;\nconst file = new FileReader();\nlet loadedPdf;\n\nexport const App = () => {\n  const pdfId = window.location.pathname.slice(1);\n  const canvasRef = useRef();\n  const [isLoading, setIsLoading] = useState(false);\n  const [link, setLink] = useState();\n  const [isEditMode, setIsEditMode] = useState(false);\n\n\n  useEffect(() => {\n    ctx = canvasRef.current.getContext('2d');\n  }, [canvasRef.current])\n\n\n  useEffect(() => {\n    if (pdfId) onGetPdf();\n  }, [pdfId])\n\n  async function onGetPdf() {\n    loadedPdf = await getPdf(pdfId);\n    if (!loadedPdf) return;\n    onRenderCtx(loadedPdf.data)\n  }\n\n  const handlePdf = async (e) => {\n    // canvasRef.current.width = 0;\n    // canvasRef.current.height = 0;\n\n    file.onload = () => {\n      onRenderCtx(file.result);\n    }\n    await file.readAsDataURL(e.target.files[0])\n  }\n\n  async function onRenderCtx(data) {\n    const doc = await pdfjsLib.getDocument(data).promise;\n    page = await doc.getPage(1);\n    const viewport = await page.getViewport({ scale: 2 });\n    canvasRef.current.height = viewport.height;\n    canvasRef.current.width = viewport.width;\n\n    renderCtx = {\n      canvasContext: ctx,\n      viewport\n    }\n\n    await page.render(renderCtx).promise;\n  }\n\n\n\n  function startPosition() {\n    if (!isEditMode) return;\n    isDrawMode = true;\n  }\n\n  function finishPosition() {\n    if (!isEditMode) return;\n    isDrawMode = false;\n    ctx.beginPath();\n\n  }\n\n  function handleMouseMove(e) {\n    if (e.nativeEvent.which !== 1 || !isDrawMode || !isEditMode) return;\n    const offsetX = e.nativeEvent.offsetX;\n    const offsetY = e.nativeEvent.offsetY;\n    draw(offsetX, offsetY);\n  }\n\n  function handleTouchMove(e) {\n    if (e.touches.length !== 1 || !isDrawMode) return;\n    var x = e.touches[0].clientX - e.touches[0].target.offsetLeft;\n    var y = e.touches[0].clientY - e.touches[0].target.offsetTop;\n    draw(x, y);\n  }\n\n  function draw(x, y) {\n    ctx.lineWidth = 5;\n    ctx.lineCap = 'round';\n    ctx.lineTo(x, y);\n    ctx.stroke();\n  }\n\n  async function clearCanvas() {\n    if (!page) return;\n    ctx.clearRect(0, 0, canvasRef.current.width, canvasRef.current.height);\n    await page.render(renderCtx).promise;\n  }\n\n  async function onSavePdf() {\n    // console.log(canvasRef.current.toDataURL(\"image/png\"));\n    setIsLoading(true);\n    const pdfToSave = { data: file.result }\n    const savedPdf = await savePdf(pdfToSave);\n    setIsLoading(false);\n    setLink(window.location.origin + '/' + savedPdf._id);\n  }\n\n  function getWhatsappHref() {\n    const data = canvasRef.current.toDataURL(\"image/png\");\n    console.log(navigator);\n    console.log(navigator.share);\n    // console.log(data);\n    // console.log(navigator);\n    // window.open(`https://wa.me/972526716633?text=${data}`);\n    // window.open(`whatsapp://send?photos=https://images.app.goo.gl/U1iPKKL6norJ45XA7')}`);\n    // window.open('https://api.whatsapp.com/send?phone=972526716633');\n\n\n  }\n\n  return (\n    <div className=\"App\">\n\n      <div className=\"nav-wrapper\">\n        <input className=\"pdf-input\" id=\"pdf-file-input\" type=\"file\" accept=\"application/pdf\" onChange={handlePdf} hidden />\n        {!pdfId ?\n          <div>\n            <label htmlFor=\"pdf-file-input\">UPLOAD</label>\n            <button onClick={onSavePdf}>GET LINK</button>\n            {isLoading && <p>Loading...</p>}\n            {link && <p>{link}</p>}\n          </div> :\n          <div>\n            <button onClick={() => setIsEditMode((prev) => !prev)}>EDIT</button>\n            <p>{isEditMode ? 'yes' : 'no'}</p>\n            <button onClick={clearCanvas}>CLEAR</button>\n            <button onClick={() => getWhatsappHref()}>SEND</button>\n          </div>}\n      </div>\n\n      <canvas ref={canvasRef} className=\"pdf-canvas\" onMouseDown={startPosition} onMouseMove={handleMouseMove}\n        onMouseUp={finishPosition} onTouchStart={startPosition} onTouchMove={handleTouchMove}\n        onTouchEnd={finishPosition} style={{ touchAction: isEditMode ? 'none' : 'auto' }}></canvas>\n\n    </div>\n  );\n}\n\nexport default App;\n","import Axios from 'axios';\r\nconst axios = Axios.create({ withCredentials: true });\r\nconst baseUrl = process.env.NODE_ENV === 'production' ? '/api/pdf' : 'http://localhost:3030/api/pdf';\r\n\r\nexport function getPdf(id) {\r\n    return axios.get(`${baseUrl}/${id}`).then(res => res.data);\r\n}\r\n\r\nexport function savePdf(pdf) {\r\n    return axios.post(baseUrl, pdf).then(res => res.data);\r\n}","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './styles/global.scss';\nimport { App } from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}